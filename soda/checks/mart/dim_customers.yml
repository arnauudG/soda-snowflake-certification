# MART Layer - Customer Dimension Table Quality Checks
# Database: SODA_CERTIFICATION, Schema: MART
# Table: dim_customers (10,000+ records)
# Purpose: Business-ready data with strictest quality requirements

checks for DIM_CUSTOMERS:
  # Row count checks
  - row_count between 8000 and 12000:
      name: "Mart customer count within expected range"
  
  # Completeness checks (no missing values allowed)
  - missing_count(customer_id) = 0:
      name: "No missing customer IDs in mart"
  
  - missing_count(first_name) = 0:
      name: "No missing first names in mart"
  
  - missing_count(last_name) = 0:
      name: "No missing last names in mart"
  
  - missing_count(email) = 0:
      name: "No missing emails in mart"
  
  # Uniqueness checks (strict)
  - duplicate_count(customer_id) = 0:
      name: "Customer IDs are unique in mart"
  
  - duplicate_count(email) = 0:
      name: "Emails are unique in mart"
  
  # Data quality score (perfect)
  - min(data_quality_score) = 100:
      name: "All customers have perfect data quality score"
  
  - avg(data_quality_score) = 100:
      name: "Average data quality score is perfect"
  
  # Validity checks (strict)
  - invalid_count(email) = 0:
      name: "All emails are valid in mart"
      valid regex: '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
  
  - invalid_count(phone) = 0:
      name: "All phone numbers are valid in mart"
      valid regex: '^[0-9\-\+\(\)\s]+$'
  
  # Freshness checks
  - freshness(created_at) < 1d:
      name: "Mart customer data is fresh"
  
  # Schema checks
  # Schema validation omitted
