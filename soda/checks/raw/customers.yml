# RAW Layer - Customers Table Quality Checks
# Database: SODA_CERTIFICATION, Schema: RAW
# Table: customers (10,000+ records)
# Purpose: Initial data quality assessment with relaxed thresholds

checks for customers:
  # Row count checks
  - row_count between 8000 and 12000:
      name: "Customer count within expected range"
  
  # Completeness checks (relaxed for raw data)
  - missing_count(CUSTOMER_ID) = 0:
      name: "No missing customer IDs"
  
  - missing_count(FIRST_NAME) < 100:
      name: "Minimal missing first names"
  
  - missing_count(LAST_NAME) < 100:
      name: "Minimal missing last names"
  
  - missing_count(EMAIL) < 1500:
      name: "Email completeness check"
  
  # Uniqueness checks
  - duplicate_count(CUSTOMER_ID) = 0:
      name: "Customer IDs are unique"
  
  - duplicate_count(EMAIL) < 200:
      name: "Email duplicates within acceptable range"
  
  # Validity checks
  - invalid_count(EMAIL) < 500:
      name: "Invalid email formats"
      valid regex: '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
  
  - invalid_count(PHONE) < 300:
      name: "Invalid phone formats"
      valid regex: '^[0-9\-\+\(\)\s]+$'
  
  # Freshness checks
  # Freshness check disabled - created_at is timestamp in nanoseconds
  # - freshness("created_at") < 1d:
  #     name: "Customer data is fresh"
  
  # Schema checks
  # Schema validation can be re-added later using Soda's columns block
